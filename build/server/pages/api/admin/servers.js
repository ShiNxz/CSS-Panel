"use strict";(()=>{var e={};e.id=514,e.ids=[514],e.modules={429:e=>{e.exports=require("cookie-session")},62418:e=>{e.exports=require("mysql2/promise")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3511:e=>{e.exports=require("passport")},53686:e=>{e.exports=require("passport-steam")},48612:e=>{e.exports=require("zod-validation-error")},99648:e=>{e.exports=import("axios")},97564:e=>{e.exports=import("chalk")},45616:e=>{e.exports=import("next-connect")},2782:e=>{e.exports=import("steam-api-sdk")},9926:e=>{e.exports=import("zod")},75115:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>c,default:()=>u,routeModule:()=>l});var a=r(88667),i=r(25828),o=r(38051),n=r(60383),d=e([n]);n=(d.then?(await d)():d)[0];let u=(0,o.l)(n,"default"),c=(0,o.l)(n,"config"),l=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/admin/servers",pathname:"/api/admin/servers",bundlePath:"",filename:""},userland:n});s()}catch(e){s(e)}})},60383:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>c});var a=r(6995),i=r(74186),o=r(36219),n=r(73153),d=r(46634),u=e([a,i,o,n,d]);[a,i,o,n,d]=u.then?(await u)():u;let c=async(e,t)=>{await i.Z.run(e,t);let{method:r}=e;if(await (0,n.Z)(e,t,["@web/root","@web/servers","@css/root"],"OR"))switch(r){case"GET":{let e=await a.Z.servers.getAll();return t.status(200).json(e)}case"POST":{let{hostname:r,address:s}=o.Z.parse(e.body);return await a.Z.servers.create({hostname:r,address:s}),(0,d.Z)("Server Create",`Admin ${e.user?.displayName} (${e.user?.id}) created server: ${r}`,e.user?.id),t.status(201).send("Server created")}default:return t.status(405).json({message:"Method not allowed"})}};s()}catch(e){s(e)}})},46634:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>n});var a=r(6995),i=r(899),o=e([a,i]);[a,i]=o.then?(await o)():o;let n=async(e,t,r)=>{try{a.Z.logs.create(e,t,r);let s=await a.Z.settings.getByKey("discordWebhook",!1);s&&(0,i.Z)({url:s,embeds:[{title:`**▬▬▬▬▬ [LOG :: ${e}] ▬▬▬▬▬**`,color:5352959,description:t,timestamp:new Date().toISOString()}]})}catch(e){error(`Failed to log: ${e}`)}};s()}catch(e){s(e)}})},73153:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>o});var a=r(6995),i=e([a]);a=(i.then?(await i)():i)[0];let o=(e,t,r,s="AND")=>new Promise(async(i,o)=>{if(!e.user)return o(t.status(400).json({success:!1,error:"Protected Route"}));let n=e.user.id,d=await a.Z.admins.getBySteam64(n);if(!d)return o(t.status(401).json({success:!1,error:"Protected Route"}));if(!r)return i(d);let u=null;if("object"==typeof d.flags)u=d.flags;else{let e=await a.Z.adminGroups.getById(d.flags);e&&(u=e.flags)}if(null===u||!("AND"===s?r.every(e=>u.includes(e)):r.some(e=>u.includes(e))))return o(t.status(403).json({success:!1,error:"Protected Route"}));i(d)});s()}catch(e){s(e)}})},36219:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>o});var a=r(9926),i=e([a]);let o=(a=(i.then?(await i)():i)[0]).z.object({address:a.z.string().refine(e=>e.includes(":"),{message:"IP Address must include a port number"}),hostname:a.z.string().min(3),rcon:a.z.string().min(0).optional()});s()}catch(e){s(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[2546],()=>r(75115));module.exports=s})();